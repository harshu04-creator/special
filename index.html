<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Memories üíï</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }
        /* Doodle Background - backmost */
        .doodle-background {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: -2;
            opacity: 0.3;
            pointer-events: none;
        }
        .doodle-background svg { width: 100%; height: 100%; }

        /* Photo Slideshow - front of doodle, back of everything else */
        .background-slideshow {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: -1;
            overflow: hidden;
        }
        .background-slides-wrapper {
            position: relative;
            width: 100%; height: 100%;
        }
        .background-slide {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            opacity: 0;
            transition: opacity 2s ease-in-out;
            z-index: 0;
        }
        .background-slide.active {
            opacity: 1;
            z-index: 1;
        }
        .background-slide img {
            width: 100%; height: 100%; object-fit: cover; display: block;
        }
        /* Optional overlay for gentle effect */
        .background-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(255, 238, 248, 0.5);
            z-index: 0;
        }
        /* Kawaii UI styling (from your previous code, unchanged!) */
        .interface { position: absolute; width: 100%; height: 100%; transition: opacity 0.5s ease; z-index: 2;}
        .interface.hidden { opacity: 0; pointer-events: none; }
        #interface1 { z-index: 2; }
        .container {
            position: relative; z-index: 1; width: 100%;
            max-width: 500px; padding: 20px; margin: 0 auto;
            display: flex; flex-direction: column; justify-content: center; height: 100vh;
        }
        .header { text-align: center; margin-bottom: 30px; animation: fadeInDown 1s ease-out; }
        .header h1 { font-size: 2.5rem; color: #ff69b4; text-shadow: 3px 3px 0px #fff, 6px 6px 0px rgba(255, 105, 180, 0.3); margin-bottom: 15px; animation: bounce 2s infinite; }
        .kawaii-hearts { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
        .kawaii-heart { font-size: 1.8rem; animation: float 3s ease-in-out infinite; will-change: transform;}
        .kawaii-heart:nth-child(2) { animation-delay: 0.5s; }
        .kawaii-heart:nth-child(3) { animation-delay: 1s; }
        .card-stack-container { position: relative; width: 100%; height: 500px; margin: 0 auto;}
        .card { position: absolute; width: 100%; height: 100%; background: white; border-radius: 25px; padding: 25px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15); cursor: grab; user-select: none; transition: transform 0.3s ease, box-shadow 0.3s ease; will-change: transform;}
        .card:active { cursor: grabbing;}
        .card-frame-1 { border: 8px solid #ffb6c1; }
        .card-frame-2 { border: 8px dashed #ffd700; }
        .card-frame-3 { border: 8px double #ff69b4; }
        .card-frame-4 { border: 8px solid #87ceeb; }
        .card-frame-5 { border: 8px dotted #ff1493; }
        .card-frame-6 { border: 8px solid #dda0dd; }
        .card-photo { position: relative; width: 100%; height: 350px; overflow: hidden; border-radius: 20px; background: #f0f0f0; margin-bottom: 15px;}
        .card-photo img { width: 100%; height: 100%; object-fit: cover;}
        .card-decoration { position: absolute; font-size: 2.5rem; z-index: 5; pointer-events: none;}
        .decoration-top-left { top: -10px; left: -10px; animation: wiggle 2s infinite;}
        .decoration-top-right { top: -10px; right: -10px; animation: wiggle 2s infinite 0.5s;}
        .decoration-bottom-left { bottom: -10px; left: -10px; animation: spin 4s linear infinite;}
        .decoration-bottom-right { bottom: -10px; right: -10px; animation: spin 4s linear infinite reverse;}
        .card-caption { text-align: center; font-size: 1.3rem; color: #ff69b4; font-weight: bold; padding: 5px;}
        .swipe-indicator {position: absolute;top: 50%;transform: translateY(-50%);font-size: 4rem;opacity: 0;transition: opacity 0.2s ease;pointer-events: none;z-index: 10;}
        .swipe-left { left: 20px;}
        .swipe-right { right: 20px;}
        .nav-buttons { display: flex; justify-content: center; gap: 30px; margin-top: 20px; animation: fadeInUp 1s ease-out;}
        .nav-button { width: 60px; height: 60px; border-radius: 50%; border: none; font-size: 2rem; cursor: pointer; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); transition: transform 0.2s ease, box-shadow 0.2s ease; display: flex; align-items: center; justify-content: center;}
        .nav-button:hover { transform: scale(1.1); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);}
        .nav-button:active { transform: scale(0.95);}
        .btn-left { background: linear-gradient(135deg, #ff6b9d 0%, #ff1493 100%);}
        .btn-right { background: linear-gradient(135deg, #69ff97 0%, #00e676 100%);}
        .counter { text-align: center; margin-top: 15px; font-size: 1.2rem; color: #ff69b4; font-weight: bold;}
        .continue-button { display: none; margin: 20px auto 0; padding: 15px 40px; font-size: 1.5rem; background: linear-gradient(135deg, #ff69b4 0%, #ff1493 100%); color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 20px rgba(255, 105, 180, 0.4); transition: all 0.3s ease; animation: pulse 2s infinite; }
        .continue-button:hover { transform: scale(1.1); box-shadow: 0 8px 30px rgba(255, 105, 180, 0.6);}
        .continue-button.show { display: block;}
        #interface2 { z-index: 1;}
        #bouncingCanvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer;}
        .floating-element { position: fixed; font-size: 2.5rem; z-index: 0; opacity: 0.6; pointer-events: none; will-change: transform;}
        .floating-1 { top: 10%; left: 5%; animation: float 4s ease-in-out infinite;}
        .floating-2 { top: 20%; right: 10%; animation: float 5s ease-in-out infinite 1s;}
        .floating-3 { bottom: 15%; left: 8%; animation: float 6s ease-in-out infinite 2s;}
        .floating-4 { bottom: 25%; right: 5%; animation: float 4.5s ease-in-out infinite 1.5s;}
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-50px);} to {opacity:1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(50px);} to {opacity:1; transform: translateY(0); } }
        @keyframes bounce { 0%,20%,50%,80%,100% {transform: translateY(0);} 40% {transform: translateY(-20px);} 60% {transform: translateY(-10px);} }
        @keyframes float { 0%,100% { transform: translateY(0px) rotate(0deg);} 50% { transform: translateY(-30px) rotate(5deg);} }
        @keyframes wiggle {0%,100% {transform: rotate(0deg);}25% {transform: rotate(-15deg);}75% {transform: rotate(15deg);}}
        @keyframes spin {from{transform:rotate(0deg);}to{transform:rotate(360deg);}}
        @keyframes pulse { 0%,100%{transform:scale(1);} 50%{transform:scale(1.05);} }
        @media (max-width: 768px) {
            .header h1 {font-size: 2rem;}
            .card-stack-container {height: 450px;}
            .card-photo {height: 300px;}
        }
    </style>
</head>
<body>
    <!-- Doodle art background (back layer) -->
    <div class="doodle-background">
        <svg width="100%" height="100%">
            <defs>
                <pattern id="doodle-pattern" x="0" y="0" width="100" height="100" patternUnits="userSpaceOnUse">
                    <circle cx="10" cy="10" r="2" fill="#ffb6c1" opacity="0.6"/>
                    <circle cx="50" cy="30" r="3" fill="#ffd700" opacity="0.5"/>
                    <circle cx="80" cy="20" r="2" fill="#87ceeb" opacity="0.6"/>
                    <path d="M25,45 Q25,40 28,40 Q31,40 31,45 Q31,48 25,52 Q19,48 19,45 Q19,40 22,40 Q25,40 25,45" fill="#ff69b4" opacity="0.4"/>
                    <line x1="60" y1="60" x2="70" y2="65" stroke="#dda0dd" stroke-width="2" opacity="0.4"/>
                    <line x1="15" y1="75" x2="25" y2="78" stroke="#ffb6c1" stroke-width="2" opacity="0.4"/>
                    <circle cx="40" cy="80" r="1.5" fill="#ff1493" opacity="0.5"/>
                    <circle cx="90" cy="70" r="1.5" fill="#ffd700" opacity="0.5"/>
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#doodle-pattern)"/>
        </svg>
    </div>
    <!-- Photo slideshow in front of doodle art -->
    <div class="background-slideshow">
        <div class="background-slides-wrapper" id="backgroundSlidesWrapper"></div>
    </div>
    <!-- Optional overlay for readability (can remove or adjust opacity/color) -->
    <div class="background-overlay"></div>
    <!-- Floating kawaii elements -->
    <div class="floating-element floating-1">üå∏</div>
    <div class="floating-element floating-2">‚ú®</div>
    <div class="floating-element floating-3">ü¶ã</div>
    <div class="floating-element floating-4">üí´</div>
    <!-- Card interface and rest of UI -->
    <div id="interface1" class="interface">
        <div class="container">
            <div class="header">
                <h1>‚ú® Special Memories ‚ú®</h1>
                <div class="kawaii-hearts">
                    <span class="kawaii-heart">üíñ</span>
                    <span class="kawaii-heart">üåü</span>
                    <span class="kawaii-heart">üíñ</span>
                </div>
                <p style="font-size: 1.3rem; color: #ff69b4;">Someone Very Special üíï</p>
            </div>
            <div class="card-stack-container" id="cardStack"></div>
            <div class="nav-buttons">
                <button class="nav-button btn-left" id="btnLeft">‚ùå</button>
                <button class="nav-button btn-right" id="btnRight">üíñ</button>
            </div>
            <div class="counter" id="counter">Card 1 of 6</div>
            <button class="continue-button" id="continueBtn">Continue to Photo Gallery ‚ú®</button>
        </div>
    </div>
    <div id="interface2" class="interface hidden">
        <canvas id="bouncingCanvas"></canvas>
    </div>
    <script>
        // ============= Background slideshow code =============
        const BACKGROUND_TRANSITION_DURATION = 3000; // 3 seconds per photo
        const BACKGROUND_PHOTO_COUNT = 100; // your photo count

        const backgroundPhotos = [];
        for (let i = 1; i <= BACKGROUND_PHOTO_COUNT; i++)
            backgroundPhotos.push(`photos/photo${i}.jpg`);

        let bgCurrentIndex = 0;
        const bgSlidesWrapper = document.getElementById('backgroundSlidesWrapper');

        function initBackgroundSlideshow() {
            backgroundPhotos.forEach((photo, index) => {
                const slide = document.createElement('div');
                slide.className = 'background-slide';
                if (index === 0) slide.classList.add('active');
                const img = document.createElement('img');
                img.src = photo;
                img.alt = `Background ${index+1}`;
                img.loading = 'lazy';
                slide.appendChild(img);
                bgSlidesWrapper.appendChild(slide);
            });
            setInterval(changeBackgroundSlide, BACKGROUND_TRANSITION_DURATION);
        }
        function changeBackgroundSlide() {
            const slides = document.querySelectorAll('.background-slide');
            slides[bgCurrentIndex].classList.remove('active');
            bgCurrentIndex = (bgCurrentIndex+1)%backgroundPhotos.length;
            slides[bgCurrentIndex].classList.add('active');
        }
        initBackgroundSlideshow();

        // ============= Card and bouncing photo UI code (unchanged) =============
        const cardData = [
            { image: 'photo1.jpg', caption: 'Beautiful Moment üíï', frame: 'card-frame-1', decorations: { topLeft: 'üå∏', topRight: 'üéÄ' } },
            { image: 'photo2.jpg', caption: 'Sweet Memories üåü', frame: 'card-frame-2', decorations: { topLeft: '‚≠ê', bottomRight: 'üåü' } },
            { image: 'photo3.jpg', caption: 'Precious Times üí´', frame: 'card-frame-3', decorations: { topRight: 'üí´', bottomLeft: '‚ú®' } },
            { image: 'photo4.jpg', caption: 'Amazing Day ü¶ã', frame: 'card-frame-4', decorations: { topLeft: 'ü¶ã', bottomRight: 'üå∫' } },
            { image: 'photo5.jpg', caption: 'Wonderful Time üíñ', frame: 'card-frame-5', decorations: { topLeft: 'üíñ', topRight: 'üíù' } },
            { image: 'photo6.jpg', caption: 'Forever Special üåà', frame: 'card-frame-6', decorations: { bottomLeft: 'üåà', bottomRight: '‚òÅÔ∏è' } }
        ];
        const cardStack = document.getElementById('cardStack'), counter = document.getElementById('counter');
        const btnLeft = document.getElementById('btnLeft'), btnRight = document.getElementById('btnRight');
        const continueBtn = document.getElementById('continueBtn');
        let currentIndex = 0, isDragging = false, startX = 0, currentCard = null;
        function initCards() {
            cardStack.innerHTML = '';
            cardData.forEach((data, idx) => cardStack.appendChild(createCard(data, idx)));
            updateCardPositions(); updateCounter();
        }
        function createCard(data, idx) {
            const card = document.createElement('div');
            card.className = `card ${data.frame}`; card.dataset.index = idx;
            card.innerHTML = `
                <div class="swipe-indicator swipe-left">üëà</div>
                <div class="swipe-indicator swipe-right">üíñ</div>
                ${data.decorations.topLeft ? `<div class="card-decoration decoration-top-left">${data.decorations.topLeft}</div>` : ''}
                ${data.decorations.topRight ? `<div class="card-decoration decoration-top-right">${data.decorations.topRight}</div>` : ''}
                ${data.decorations.bottomLeft ? `<div class="card-decoration decoration-bottom-left">${data.decorations.bottomLeft}</div>` : ''}
                ${data.decorations.bottomRight ? `<div class="card-decoration decoration-bottom-right">${data.decorations.bottomRight}</div>` : ''}
                <div class="card-photo"><img src="${data.image}" alt="${data.caption}"></div>
                <div class="card-caption">${data.caption}</div>
            `;
            return card;
        }
        function updateCardPositions() {
            const cards = cardStack.querySelectorAll('.card');
            cards.forEach((card, idx) => {
                const cardIdx = parseInt(card.dataset.index);
                const pos = cardIdx-currentIndex;
                if (pos<0) card.style.display='none';
                else {
                    card.style.display='block';
                    card.style.transform = `translateY(${pos*10}px) scale(${1-pos*0.05}) rotate(0deg)`;
                    card.style.zIndex = cards.length-pos; card.style.opacity = pos<3?1:0; card.style.pointerEvents=pos===0?'auto':'none';
                }
            });
        }
        function swipeCard(dir) {
            const card = cardStack.querySelector(`.card[data-index="${currentIndex}"]`); if(!card) return;
            const translateX = dir==='right'?1000:-1000, rotate = dir==='right'?20:-20;
            card.style.transition='transform 0.5s ease, opacity 0.5s ease';
            card.style.transform=`translateX(${translateX}px) rotate(${rotate}deg)`; card.style.opacity='0';
            createSparkles(card);
            setTimeout(()=>{
                currentIndex++;
                if(currentIndex>=cardData.length) continueBtn.classList.add('show');
                else { updateCardPositions(); updateCounter(); }
            },500);
        }
        function updateCounter() { counter.textContent = `Card ${currentIndex+1} of ${cardData.length}`; }
        function createSparkles(el) {
            const sparkles = ['‚ú®','üí´','‚≠ê','üåü','üíñ'];
            const rect=el.getBoundingClientRect();
            for(let i=0;i<8;i++){
                const sparkle=document.createElement('div');
                sparkle.textContent=sparkles[Math.floor(Math.random()*sparkles.length)];
                sparkle.style.position='fixed';
                sparkle.style.left=rect.left+rect.width/2+(Math.random()-0.5)*200+'px';
                sparkle.style.top=rect.top+rect.height/2+(Math.random()-0.5)*200+'px';
                sparkle.style.fontSize='2rem';
                sparkle.style.pointerEvents='none';
                sparkle.style.zIndex='10000';
                sparkle.style.transition='all 1s ease-out';
                document.body.appendChild(sparkle);
                setTimeout(()=>{sparkle.style.transform='translateY(-150px) scale(1.5)';sparkle.style.opacity='0';},10);
                setTimeout(()=>{document.body.removeChild(sparkle);},1000);
            }
        }
        cardStack.addEventListener('mousedown',startDrag);
        cardStack.addEventListener('mousemove',drag);
        cardStack.addEventListener('mouseup',endDrag);
        cardStack.addEventListener('mouseleave',endDrag);
        cardStack.addEventListener('touchstart',startDrag);
        cardStack.addEventListener('touchmove',drag);
        cardStack.addEventListener('touchend',endDrag);
        function startDrag(e) {
            currentCard = cardStack.querySelector(`.card[data-index="${currentIndex}"]`);
            if(!currentCard)return;
            isDragging=true;
            startX=e.type==='mousedown'?e.clientX:e.touches[0].clientX;
            currentCard.style.transition='none';
        }
        function drag(e) {
            if(!isDragging || !currentCard) return;
            e.preventDefault();
            const currentX = e.type==='mousemove'?e.clientX:e.touches[0].clientX;
            const deltaX = currentX-startX;
            const rotate = deltaX*0.1;
            currentCard.style.transform=`translateX(${deltaX}px) rotate(${rotate}deg)`;
            const leftIndicator=currentCard.querySelector('.swipe-left');
            const rightIndicator=currentCard.querySelector('.swipe-right');
            if(deltaX<-50){ leftIndicator.style.opacity=Math.min(Math.abs(deltaX)/150,1); rightIndicator.style.opacity=0;}
            else if(deltaX>50){ rightIndicator.style.opacity=Math.min(deltaX/150,1); leftIndicator.style.opacity=0;}
            else{leftIndicator.style.opacity=0;rightIndicator.style.opacity=0;}
        }
        function endDrag(e){
            if(!isDragging||!currentCard)return;
            isDragging=false;
            const currentX = e.type==='mouseup'?e.clientX:e.changedTouches[0].clientX;
            const deltaX = currentX-startX;
            currentCard.querySelector('.swipe-left').style.opacity=0;
            currentCard.querySelector('.swipe-right').style.opacity=0;
            if(Math.abs(deltaX)>100)swipeCard(deltaX>0?'right':'left');
            else{currentCard.style.transition='transform 0.3s ease';currentCard.style.transform='translateX(0) rotate(0deg)';}
        }
        btnLeft.addEventListener('click',()=>swipeCard('left'));
        btnRight.addEventListener('click',()=>swipeCard('right'));
        continueBtn.addEventListener('click',()=>{
            document.getElementById('interface1').classList.add('hidden');
            document.getElementById('interface2').classList.remove('hidden');
            initBouncingPhotos();
        });
        initCards();

        // Bouncing photo canvas code unchanged...

        const canvas = document.getElementById('bouncingCanvas');
        const ctx = canvas.getContext('2d');
        let photos = [];
        function initBouncingPhotos() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            for(let i=0;i<50;i++){
                const photoNum=(i%6)+1;
                photos.push(new Photo(`photo${photoNum}.jpg`,i));
            }
            animate();
        }
        class Photo {
            constructor(src,index){
                this.img=new Image();this.img.src=src;
                this.size=60+Math.random()*40;
                this.x=Math.random()*(canvas.width-this.size);
                this.y=Math.random()*(canvas.height-this.size);
                this.vx=(Math.random()-0.5)*4;this.vy=(Math.random()-0.5)*4;
                this.rotation=Math.random()*Math.PI*2;
                this.rotationSpeed=(Math.random()-0.5)*0.05;
                this.loaded=false;this.img.onload=()=>{this.loaded=true;}
            }
            update(){
                this.x+=this.vx; this.y+=this.vy; this.rotation+=this.rotationSpeed;
                if(this.x<=0||this.x+this.size>=canvas.width){this.vx=-this.vx;this.x=this.x<=0?0:canvas.width-this.size;}
                if(this.y<=0||this.y+this.size>=canvas.height){this.vy=-this.vy;this.y=this.y<=0?0:canvas.height-this.size;}
            }
            draw(){
                if(!this.loaded)return;
                ctx.save();
                ctx.translate(this.x+this.size/2,this.y+this.size/2);
                ctx.rotate(this.rotation);
                ctx.strokeStyle='#ff69b4';ctx.lineWidth=3;
                ctx.strokeRect(-this.size/2-2,-this.size/2-2,this.size+4,this.size+4);
                ctx.drawImage(this.img,-this.size/2,-this.size/2,this.size,this.size);
                ctx.restore();
            }
            checkCollision(other){
                const dx=(this.x+this.size/2)-(other.x+other.size/2);
                const dy=(this.y+this.size/2)-(other.y+other.size/2);
                const dist=Math.sqrt(dx*dx+dy*dy); const minDist=(this.size+other.size)/2;
                if(dist<minDist){
                    const angle=Math.atan2(dy,dx), sin=Math.sin(angle), cos=Math.cos(angle);
                    const vx1=this.vx*cos+this.vy*sin, vy1=this.vy*cos-this.vx*sin;
                    const vx2=other.vx*cos+other.vy*sin, vy2=other.vy*cos-other.vx*sin;
                    const finalVx1=vx2, finalVx2=vx1;
                    this.vx=finalVx1*cos-vy1*sin;this.vy=vy1*cos+finalVx1*sin;
                    other.vx=finalVx2*cos-vy2*sin;other.vy=vy2*cos+finalVx2*sin;
                    const overlap=minDist-dist;
                    const separateX=overlap*cos/2,separateY=overlap*sin/2;
                    this.x+=separateX;this.y+=separateY;
                    other.x-=separateX;other.y-=separateY;
                }
            }
        }
        function animate(){
            ctx.clearRect(0,0,canvas.width,canvas.height);
            photos.forEach(photo=>{photo.update();photo.draw();});
            for(let i=0;i<photos.length;i++)
                for(let j=i+1;j<photos.length;j++)
                    photos[i].checkCollision(photos[j]);
            requestAnimationFrame(animate);
        }
        window.addEventListener('resize',()=>{
            if(!document.getElementById('interface2').classList.contains('hidden')){
                canvas.width=window.innerWidth;canvas.height=window.innerHeight;
            }
        });
        canvas.addEventListener('click',e=>{
            const sparkles=['‚ú®','üí´','‚≠ê','üåü','üíñ','üå∏'];
            for(let i=0;i<10;i++){
                const sparkle=document.createElement('div');
                sparkle.textContent=sparkles[Math.floor(Math.random()*sparkles.length)];
                sparkle.style.position='fixed';
                sparkle.style.left=e.clientX+(Math.random()-0.5)*100+'px';
                sparkle.style.top=e.clientY+(Math.random()-0.5)*100+'px';
                sparkle.style.fontSize='2rem';sparkle.style.pointerEvents='none';sparkle.style.zIndex='10000';sparkle.style.transition='all 1.5s ease-out';
                document.body.appendChild(sparkle);
                setTimeout(()=>{sparkle.style.transform='translateY(-200px) scale(2)';sparkle.style.opacity='0';},10);
                setTimeout(()=>{document.body.removeChild(sparkle);},1500);
            }
        });
    </script>
</body>
    </html>
